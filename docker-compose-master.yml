version: '3'

services:
  database:
    container_name: database
    image: database
    build:
      context: database
    env_file: config/variables.env
    volumes:
      - ./volumes/backups:/root/backups

  wikifarm-master:
    container_name: wikifarm-master
    image: wikifarm-master
    build:
      context: wikifarm
      dockerfile: Dockerfile-master
    env_file: config/variables.env
    environment:
      MEDIAWIKI_PORT: ${MW_PORT}
    ports:
      - "${MW_PORT}:80"
    volumes:
      - ./volumes/config/master:/var/www/wikifarm/config
      - ./volumes/extensions/master:/var/www/mediawiki/extensions
      - ./volumes/instances:/var/www/wikifarm/instances
